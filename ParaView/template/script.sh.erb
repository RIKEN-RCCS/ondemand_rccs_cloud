# Set xfce environment and _VIRTUALGL
<%= set_xfce(is_vgl(context.global_queue, context.global_gpus)) %>

# Select Paraview
if [ "$(arch)" = "x86_64" ]; then
  PARAVIEW_PATH=/opt/ParaView/bin/paraview
else
  PARAVIEW_PATH=/usr/bin/paraview
fi

# Start Paraview
<% if !context.global_input_file.to_s.empty? %>
${_VIRTUALGL} "$PARAVIEW_PATH" "<%= context.global_input_file %>" &
<% else %>
${_VIRTUALGL} "$PARAVIEW_PATH" &
<% end %>

# Start up xfce desktop (block until user logs out of desktop)
xfce4-session
